<!DOCTYPE html><html lang="en"><meta charset="UTF-8"><meta name="description" content="Sections, Style and Meta Data"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Team Watch</title><meta name="theme-color" content="#8bc34a"><link rel="manifest" href="../manifest.json"><link rel="stylesheet" href="../css/main.css"><body><script src="../firebase.js"></script><script src="../firebase-firestore.js"></script><div class="header"><h1>Team Watch</h1></div><table id="header-table"><tr><td class="header-td"><a class="header-link" href="../index.html">Home</a></td><td class="header-td active"><a class="header-link" href="game_schedule.html">Game</a></td><td class="header-td"><a class="header-link" href="../player/player_list.html">Player</a></td><td class="header-td"><a class="header-link" href="../manage/view_profile.html">Manage</a></td></tr></table><br><h1 style="color:#000">Edit Game</h1><br><table class="playerinfo"><tr><td><label>Opponent Team:</label></td><td><input name="opponent" id="oppTeam"><tr><td><label>Date:</label></td><td><input type="date" name="date" id="date"><tr><td><label>Time:</label></td><td><input type="time" name="time" id="time"><tr><td><label>Location:</label></td><td><input name="loc" id="loc"><tr><td><label>Status:</label></td><td><input id="homeOption" class="homeOrAway" type="radio" name="homeOrAwayType" value="Home"><label>Home</label><tr><td><label></label></td><td><input id="awayOption" class="homeOrAway" type="radio" name="homeOrAwayType" value="Away"><label>Away</label></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></table><div class="center" style="border-radius:.25rem"><input id="editGame" style="width:12rem;border-radius:.25rem" type="submit" value="Edit" class="button" onclick='location.href="game_schedule.html"'></div><div class="center" style="border-radius:.25rem"><input id="deleteGame" style="width:12rem;border-radius:.25rem" type="submit" value="Delete" class="redbutton" onclick='location.href="game_schedule.html"'></div><script src="../init.js"></script><script>function writeGameData(e,t){var o=localStorage.getItem("gameId"),a=document.getElementById("date").value,l=document.getElementById("time").value,n=new Date((a+" "+l).replace(/-/g,"/"));t.date=Math.round(n.getTime()/1e3),firebase.firestore().collection(e).doc(o).update({oppTeam:t.oppTeam,date:t.date,homeOrAway:t.homeOrAway,loc:t.loc}).then(function(){location.href="game_schedule.html"})}function getDateStr(e,t){var o=new Date(1e3*e),a=o.getDate(),l=o.getMonth()+1,n=o.getFullYear(),c=o.getHours(),s=o.getMinutes();o.getSeconds();return s=s<10?"0"+s:s,c=c<10?"0"+c:c,l=l<10?"0"+l:l,a=a<10?"0"+a:a,t?n+"-"+l+"-"+a:c+":"+s}function deleteGame(e,t){db.collection("teams/"+e+"/gameSchedule/").doc(t).delete().then(function(){}).then(function(e){location.href="game_schedule.html"})}var db=firebase.firestore();firebase.firestore().enablePersistence().catch(function(e){console.log(e)}),firebase.auth().onAuthStateChanged(function(e){var t=null;if(e){var o=localStorage.getItem("gameId"),a=localStorage.getItem("coachuid"),l="teams/"+a+"/gameSchedule/";firebase.firestore().collection(l).doc(o).get().then(function(e){(t=e.data()).time=getDateStr(t.date),t.date=getDateStr(t.date,!0);for(var o=document.querySelectorAll("td > input"),a=0;a<o.length-2;++a){var l=o[a].getAttribute("id");o[a].value=t[l]}for(o=document.querySelectorAll(".homeOrAway"),a=0;a<o.length;++a)o[a].value==t.homeOrAway&&(o[a].checked="checked")}),document.getElementById("deleteGame").onclick=function(){void 0!=t.homeGoals?firebase.firestore().collection("teams/"+a+"/stats").get().then(function(e){var l=e.docs;e.forEach(function(e){l=e.data()}),l.goalsagainst=l.goalsagainst-t.oppgoals,l.goalsfor=l.goalsfor-t.homegoals,t.homegoals>t.oppgoals?l.wins=l.wins-1:t.homegoals<t.oppgoals?l.losses=l.losses-1:l.ties=l.ties-1,firebase.firestore().collection("teams/"+a+"/stats").doc("0").set({goalsAgainst:l.goalsAgainst,goalsFor:l.goalsFor,wins:l.wins,losses:l.losses,ties:l.ties}).then(function(){deleteGame(a,o)})}):deleteGame(a,o)},document.getElementById("editGame").onclick=function(){var e={oppTeam:"",time:"",loc:"",homeOrAway:"",score:""};e.oppTeam=document.getElementById("oppTeam").value,e.time=document.getElementById("time").value,e.date=document.getElementById("date").value,e.loc=document.getElementById("loc").value;for(var t=document.getElementsByName("homeOrAwayType"),o=0;o<t.length;++o)1==t[o].checked&&(e.homeOrAway=t[o].value);writeGameData(l,e)}}else location.href="../login.html"})</script></body></html>