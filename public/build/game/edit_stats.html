<!DOCTYPE html><html lang="en"><meta charset="UTF-8"><meta name="description" content="Sections, Style and Meta Data"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Team Watch</title><meta name="theme-color" content="#8bc34a"><link rel="manifest" href="../manifest.json"><link rel="stylesheet" href="../css/main.css"><style>.dropbtn{background-color:#4caf50;color:#fff;padding:16px;font-size:16px;border:none}.dropdown{position:relative;display:inline-block}.dropdown-content{display:none;position:absolute;background-color:#f9f9f9;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);z-index:1}.dropdown-content li:nth-child(odd){float:right}.dropdown-content li{width:12vw;color:#000;padding:12px 16px;text-decoration:none;display:block}.dropdown-content li:hover{background-color:#f1f1f1}.dropdown:hover .dropdown-content{display:block;width:30vw}.dropdown:hover .dropbtn{background-color:#3e8e41}.game-stats-live-header{width:50%;margin:auto;border-spacing:3vh}.game-stats-live-header tr td:first-child{float:right}.game-stats-live-header td:nth-child(-n+2){width:25%}.game-stats-live-header td:nth-child(n+3){width:50%}.score{font-size:2rem}.game-stats-live{width:70%;margin:auto;border-spacing:1vh}.game-stats-live tr{text-align:center}.stat-type{font-size:1.3rem}button[class~=minus-button]+div{right:0}.edit-stats-button{padding:.5rem .7rem .5rem .7rem;font-size:1rem;background-color:#868e95;color:#fff}.minus-button{padding-left:1rem;padding-right:1rem}</style><body><script src="../firebase.js"></script><script src="../firebase-firestore.js"></script><div class="header"><h1>Team Watch</h1></div><table id="header-table"><tr><td class="header-td"><a class="header-link" href="../index.html">Home</a></td><td class="header-td active"><a class="header-link" href="game_schedule.html">Game</a></td><td class="header-td"><a class="header-link" href="../player/player_list.html">Player</a></td><td class="header-td"><a class="header-link" href="../manage/view_profile.html">Manage</a></td></tr></table><br><div class="center"><h1 style="color:#000">Game Statistics Live</h1><br></div><table class="game-stats-live-header"><tr><td><img alt="profile pic" width="75" height="75" src="../images/profilepic.jpg"></td><td><h1 style="color:#000" id="teamName">-</h1></td><td><p id="time"><strong>Time:</strong> 00:00:00</p><tr><td><p id="homeScore" class="score">0</p><p id="homeName">-</p></td><td style="border-left:1px solid;padding-left:2vw"><p id="oppScore" class="score">0</p><p id="oppName">-</p></td><td><label>Possession</label><input id="possCheckBox" class="possession" type="checkbox" value="" onclick="handleCheck()"><p id="possTime" style="margin-top:2vh">Possession Time: 00:00:00</p></td></tr></td></tr></table><hr><br><table class="game-stats-live"><tr><td><div id="shotsp" class="dropdown"><button class="dropbtn">+</button></div></td><td><p class="stat-type">Shot On Goals</p></td><td><div id="shotsm" class="dropdown"><button class="dropbtn minus-button">-</button></div><tr><td><div id="gksp" class="dropdown"><button class="dropbtn">+</button></div></td><td><p class="stat-type">Goal Kicks</p></td><td><div id="gksm" class="dropdown"><button class="dropbtn minus-button">-</button></div><tr><td><div id="throwsp" class="dropdown"><button class="dropbtn">+</button></div></td><td><p class="stat-type">Throw In</p></td><td><div id="throwsm" class="dropdown"><button class="dropbtn minus-button">-</button></div><tr><td><div id="cksp" class="dropdown"><button class="dropbtn">+</button></div></td><td><p class="stat-type">Corner Kicks</p></td><td><div id="cksm" class="dropdown"><button class="dropbtn minus-button">-</button></div><tr><td><div id="foulsp" class="dropdown"><button class="dropbtn">+</button></div></td><td><p class="stat-type">Fouls</p></td><td><div id="foulsm" class="dropdown"><button class="dropbtn minus-button">-</button></div><tr><td><div id="goalsp" class="dropdown"><button class="dropbtn">+</button></div></td><td><p class="stat-type">Goals</p></td><td><div id="goalsm" class="dropdown"><button class="dropbtn minus-button">-</button></div><tr><td><div id="gap" class="dropdown"><button class="dropbtn" onclick='updatePlayerInfo("","gap","")'>+</button></div></td><td><p class="stat-type">Goals Against</p></td><td><div id="gam" class="dropdown"><button class="dropbtn minus-button" onclick='updatePlayerInfo("","gam","")'>-</button></div><tr><td><div id="pksp" class="dropdown"><button class="dropbtn">+</button></div></td><td><p class="stat-type">Penalty Kick</p></td><td><div id="pksm" class="dropdown"><button class="dropbtn minus-button">-</button></div><tr><td></td><td><div id="appear" class="dropdown"><button class="dropbtn">Appearance</button></div></td><td></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></table><div class="center"><br><br><button class="button center" id="doneBtn">Done</button></div><br><br><script src="../init.js"></script><script>function totalTimer(e){var o=maxTime-((Date.now()-e)/1e3|0);return 1==totalBegin&&(totalBegin=!1,startTimeTotal=o),startTimeTotal-o}function possTimer(e){var o=maxTime-((Date.now()-e)/1e3|0);return 1==possBegin&&(possBegin=!1,startTimePoss=o),startTimePoss-o+prevTime}function displayTime(e,o,s){var a=o/60%60|0,t=o%60|0,m=(m=o/60/60|0)<10?"0"+m:m;a=a<10?"0"+a:a,t=t<10?"0"+t:t;s.textContent=e+m+":"+a+":"+t}function pausePossTime(){var e=document.querySelector("#possTime").textContent,o=e.split(":");e=60*+o[1].substring(1)*60+60*+o[2]+ +o[3],prevTime=e,clearInterval(intervalId)}function resumePossTime(){var e=Date.now(),o=document.querySelector("#possTime");displayTime(preContent,possTimer(e),o),intervalId=setInterval(function(){displayTime(preContent,possTimer(e),o)},1e3)}function handleCheck(){document.querySelector("#possCheckBox").checked?resumePossTime():pausePossTime()}function updatePlayerInfo(e,o,s){var a=newPlayerInfo[e];switch(o){case"shotsp":"opponent"!=e?(a.shots=Number(a.shots)+1,game.homeShots=Number(game.homeShots)+1):game.oppShots=Number(game.oppShots)+1;break;case"shotsm":if("opponent"==e)game.oppShots=Number(game.oppShots)-1;else{(t=Number(a.shots)-1)>=0&&(a.shots=t,game.homeShots=Number(game.homeShots)-1)}break;case"gksp":"opponent"==e?game.oppGks=Number(game.oppGks)+1:(a.gks=Number(a.gks)+1,game.homeGks=Number(game.homeGks)+1);break;case"gksm":if("opponent"==e)game.oppGks=Number(game.oppGks)-1;else{(t=Number(a.gks)-1)>=0&&(a.gks=t,game.homeGks=Number(game.homeGks)-1)}break;case"throwsp":"opponent"==e?game.oppThrows=Number(game.oppThrows)+1:(a.throws=Number(a.throws)+1,game.homeThrows=game.homeThrows+1);break;case"throwsm":if("opponent"==e)game.oppThrows=Number(game.oppThrows)-1;else{(t=Number(a.throws)-1)>=0&&(a.throws=t,game.throws=game.throws-1)}break;case"cksp":"opponent"==e?game.oppCks=Number(game.oppCks)+1:(a.cks=Number(a.cks)+1,game.homeCks=Number(game.homeCks)+1);break;case"cksm":if("opponent"==e)game.oppCks=Number(game.oppCks)-1;else{(t=Number(a.cks)-1)>=0&&(a.cks=t,game.homeCks=Number(game.homeCks)-1)}break;case"foulsp":"opponent"==e?game.oppFouls=Number(game.oppFouls)+1:(a.fouls=Number(a.fouls)+1,game.homeFouls=Number(game.homeFouls)+1);break;case"foulsm":if("opponent"==e)game.oppFouls=Number(game.oppFouls)-1;else{(t=Number(a.fouls)-1)>=0&&(a.fouls=t,game.homeFouls=Number(game.homeFouls)-1)}break;case"goalsp":game.homeGoals=Number(game.homeGoals)+1,a.goals=Number(a.goals)+1;(m=document.querySelector("#homeScore")).textContent=game.homeGoals;break;case"goalsm":if((t=Number(a.goals)-1)>=0){game.homeGoals=Number(game.homeGoals)-1,a.goals=t;(m=document.querySelector("#homeScore")).textContent=game.homeGoals}break;case"gap":game.oppGoals=Number(game.oppGoals)+1;(m=document.querySelector("#oppScore")).textContent=game.oppGoals;break;case"gam":if((t=Number(game.oppGoals)-1)>=0){game.oppGoals=t;(m=document.querySelector("#oppScore")).textContent=game.oppGoals}break;case"pksp":"opponent"==e?game.oppPks=Number(game.oppPks)+1:(a.pks=Number(a.pks)+1,game.homePks=Numer(game.homePks)+1);break;case"pksm":if("opponent"==e)game.oppPks=Number(game.oppPks)-1;else{var t;(t=Number(a.pks)-1)>=0&&(a.pks=t,game.homePks=Numer(game.homePks)-1)}break;case"appear":a.appeared=!a.appeared,a.appeared?a.games=Number(a.games)+1:a.games=Number(a.games)-1;(m=document.querySelector("#"+o+s+"img")).style.backgroundColor="orange"}if("gap"!=o&&"gam"!=o){var m=document.querySelector("#"+o+s);"p"==o.substring(o.length-1)?(m.textContent=Number(m.textContent)+1,(m=document.querySelector("#"+o.substring(0,o.length-1)+"m"+s)).textContent=Number(m.textContent)+1):"m"==o.substring(o.length-1)&&Number(m.textContent-1>=0)&&(m.textContent=Number(m.textContent)-1,(m=document.querySelector("#"+o.substring(0,o.length-1)+"p"+s)).textContent=Number(m.textContent)-1)}}var db=firebase.firestore();firebase.firestore().enablePersistence().catch(function(e){console.log(e)});var intervalId,maxTime=86400,startTimeTotal=0,totalBegin=!0,startTimePoss=0,prevTime=0,possBegin=!0,preContent="Possession Time: ",gameId=localStorage.getItem("gameId"),groupKey=localStorage.getItem("coachuid"),players=null,newPlayerInfo={};firebase.auth().onAuthStateChanged(function(e){if(e){var o="teams/"+groupKey+"/";firebase.database();firebase.firestore().collection(o+"gameSchedule/").doc(gameId).get().then(function(e){var s=document.querySelector("#time"),a=Date.now();displayTime("",totalTimer(a,s),s),setInterval(function(){displayTime("",totalTimer(a,s),s)},1e3);var t=document.querySelectorAll(".dropdown"),m=e.data();firebase.firestore().collection(o+"playerlist/").get().then(function(e){if(null!=e){players=e.docs;for(var o=0;o<t.length;++o){var s=t[o].id;if("gap"!=s&&"gam"!=s){var a=document.createElement("div");a.className="dropdown-content";var m=document.createElement("ul"),r=0;e.forEach(function(e){var o=e.data();o.id=e.id,o.appeared=!1,newPlayerInfo[e.id]=o,""!=m.innerHTML?m.innerHTML=m.innerHTML+'<li  id="'+s+r+"img\" onclick=updatePlayerInfo('"+o.id+"','"+s+"','"+r+'\')><img alt="profile pic" src="'+o.profile_pic+'" width=50 height=50><p>'+o.name+'</p><p id="'+s+r+'">0</p></li>':m.innerHTML='<li id="'+s+r+"img\" onclick=updatePlayerInfo('"+o.id+"','"+s+"','"+r+"')><img id=\""+s+r+'img"alt="profile pic" src="'+o.profile_pic+'" width=50 height=50><p>'+o.name+'</p><p id="'+s+r+'">0</p></li>',++r}),"appear"!=s&&"goalsm"!=s&&"goalsp"!=s&&"gam"!=s&&"gap"!=s&&(m.innerHTML=m.innerHTML+'<li  id="'+s+r+"img\" onclick=updatePlayerInfo('opponent','"+s+"','"+r+'\')><img alt="profile pic" src="../images/profilepic.jpg" width=50 height=50><p>opponent</p><p id="'+s+r+'">0</p></li>',++r),1==r&&(a.style.width="15vh"),a.appendChild(m),t[o].appendChild(a)}}}});document.querySelector("#homeName").textContent=m.homeTeam;document.querySelector("#teamName").textContent=m.homeTeam;document.querySelector("#oppName").textContent=m.oppTeam},function(e){console.log("Error: "+e.code)})}else location.href="../login.html"});var game={homeGoals:0,homeShots:0,homeRed:0,homeYel:0,homeFouls:0,homePks:0,homeCks:0,homeGks:0,homeThrows:0,homePoss:"0%",oppGoals:0,oppShots:0,oppRed:0,oppYel:0,oppFouls:0,oppPks:0,oppCks:0,oppGks:0,oppThrows:0,oppPoss:"0%"};document.getElementById("doneBtn").onclick=function(){for(var e in newPlayerInfo)player=newPlayerInfo[e],firebase.firestore().collection("teams/"+groupKey+"/playerlist/").doc(e).update({games:player.games,goals:player.goals,shots:player.shots,fouls:player.fouls,pks:player.pks,cks:player.cks,gks:player.gks,throws:player.throws});var o=document.querySelector("#possTime").textContent.split(":"),s=document.querySelector("#time").textContent.split(":");s=60*Number(s[0])*60+60*Number(s[1])+Number(s[2]),o=60*Number(o[1])*60+60*Number(o[2])+Number(o[3]);var a=0,t=0;if(0!=s)t=100-(a=Math.round(o/s*100));firebase.firestore().collection("teams/"+groupKey+"/gameSchedule/").doc(gameId).update({homeGoals:game.homeGoals,homeShots:game.homeShots,homeRed:game.homeRed,homeYel:game.homeYel,homeFouls:game.homeFouls,homePks:game.homePks,homeCks:game.homeCks,homeGks:game.homeGks,homeThrows:game.homeThrows,homePoss:a+"%",oppGoals:game.oppGoals,oppShots:game.oppShots,oppRed:game.oppRed,oppYel:game.oppYel,oppFouls:game.oppFouls,oppPks:game.oppPks,oppCks:game.oppCks,oppGks:game.oppGks,oppThrows:game.oppThrows,oppPoss:t+"%"}).then(function(){firebase.firestore().collection("teams/"+groupKey+"/stats").get().then(function(e){var o=e.docs;e.forEach(function(e){o=e.data(),console.log(o)}),0==o.length&&(o={goalsFor:0,goalsAgainst:0,wins:0,losses:0,ties:0}),o.goalsAgainst=o.goalsAgainst+game.oppGoals,o.goalsFor=o.goalsFor+game.homeGoals,game.homeGoals>game.oppGoals?o.wins=o.wins+1:game.homeGoals<game.oppGoals?o.losses=o.losses+1:o.ties=o.ties+1,firebase.firestore().collection("teams/"+groupKey+"/stats").doc("0").set({goalsAgainst:o.goalsAgainst,goalsFor:o.goalsFor,wins:o.wins,losses:o.losses,ties:o.ties}).then(function(){location.href="game_schedule.html"})})})}</script></body></html>