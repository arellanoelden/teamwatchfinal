<!DOCTYPE html><html lang="en"><meta charset="UTF-8"><meta name="description" content="Sections, Style and Meta Data"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Team Watch</title><meta name="theme-color" content="#8bc34a"><link rel="manifest" href="../manifest.json"><link rel="stylesheet" href="../css/main.css"><body><script src="../firebase.js"></script><script src="../firebase-firestore.js"></script><div class="header"><h1>Team Watch</h1></div><table id="header-table"><tr><td class="header-td"><a class="header-link" href="../index.html">Home</a></td><td class="header-td"><a class="header-link" href="../game/game_schedule.html">Game</a></td><td class="header-td"><a class="header-link" href="../player/player_list.html">Player</a></td><td class="header-td active"><a class="header-link" href="view_profile.html">Manage</a></td></tr></table><script>var loadfile=function(e){document.getElementById("profile_pic").src=URL.createObjectURL(e.target.files[0])}</script><table class="playerinfo"><tr><td><img id="profile_pic" src="../images/profilepic.jpg" alt="profile pic"></td><td><input onchange="loadfile(event)" style="border-radius:.25rem" type="file" value="Add a photo" class="button" id="addphoto"><tr><td><label>First Name:</label></td><td><input name="fname" id="fname"><tr><td><label>Last Name:</label></td><td><input name="lname" id="lname"><tr><td><label>Date of Birth:</label></td><td><input name="DOB" id="DOB"></td></tr></td></tr></td></tr></td></tr></table><div class="center" style="border-radius:.25rem"><input style="border-radius:.25rem;width:21rem" type="submit" value="Save" class="button" onclick='location.href="../index.html"' ofile id="editProfile"></div><div class="center" style="border-radius:.25rem"><input style="border-radius:.25rem" type="submit" value="Delete" class="redbutton" onclick='location.href="../index.html"' id="deleteProfile"></div><script src="../init.js"></script><script>function fillInPicture(e){if("exists"==e.photoURL){firebase.storage().ref().child(e.uid).getDownloadURL().then(function(e){document.getElementById("profile_pic").src=e}).catch(function(e){console.log(e)})}}function writeProfileData(e,t){e.updateProfile({displayName:t.name,photoURL:t.profile_pic}).then(function(){db.collection("users/").doc(e.uid).update({fname:t.fname,lname:t.lname,DOB:t.DOB}).then(function(){uploadPicture()})}).catch(function(e){console.log(e)})}function uploadPicture(){var e=firebase.auth().currentUser,t=document.getElementById("addphoto").files,n=firebase.storage().ref();1==t.length?n.child(e.uid).put(t[0]).then(function(e){location.href="view_profile.html"}):location.href="view_profile.html"}function deleteAccount(){firebase.auth().currentUser.delete().then(function(){location.href="../login.html"}).catch(function(e){})}var db=firebase.firestore();firebase.auth().onAuthStateChanged(function(e){if(e){fillInPicture(e);var t=null;db.collection("users/").doc(e.uid).get().then(function(e){t=e.data();for(var n="",o=document.querySelectorAll(".playerinfo tr td:nth-child(2) > :first-child"),l=document.querySelectorAll(".playerinfo tr td img"),i=0;i<o.length;i++)o[i].hasAttribute("id")&&t[o[i].getAttribute("id")]&&(n=o[i].getAttribute("id"),o[i].setAttribute("value",t[n]));for(i=0;i<l.length;i++)if(l[i].hasAttribute("id")&&t[l[i].getAttribute("id")]){n=l[i].getAttribute("id");"IMG"==l[i].tagName?l[i].setAttribute("src",t[n]):l[i].textContent=t[n]}}).then(function(){document.getElementById("deleteProfile").onclick=function(){console.log(e.uid),"coach"==t.usertype&&(console.log("deleting"),db.collection("groups/").doc(e.uid).delete().then(function(){}).then(function(){console.log("Group successfully deleted!"),db.collection("teams/").doc(e.uid).delete().then(function(){}).then(function(){console.log("Team successfully deleted!")})})),db.collection("users").doc(e.uid).delete().then(function(){console.log(e.uid),console.log("User successfully deleted!")}).then(function(){deleteAccount()})}})}else location.href="../login.html"}),document.getElementById("editProfile").onclick=function(){var e={fname:"",lname:"",name:"",DOB:"",profile_pic:""};e.fname=document.getElementById("fname").value,e.lname=document.getElementById("lname").value,e.DOB=document.getElementById("DOB").value,e.name=document.getElementById("fname").value+" "+document.getElementById("lname").value;var t=firebase.auth().currentUser;("exists"==t.photoURL||document.getElementById("addphoto").files[0])&&(e.profile_pic="exists"),writeProfileData(t,e)}</script></body></html>